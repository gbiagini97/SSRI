# Comunicazione sicura: i protocolli crittografici

## Definizione del contesto

### Comunicazione sicura lungo un canale insicuro

Indichiamo con la parola **canale** il mezzo tramite il quale due entita' possono comunicare.
Quando il canale e' accessibile anche ad altre entita', oltre a quelle che vogliono comunicare tra di loro, allora il canale si dice **insicuro**.
Poiche' internet e' un canale diviso tra moltissimi utenti, e' definitivamente un canale insicuro.

Nella comunicazione tra persone, browser/server, online banking client/server, router, e' necessario che le informazioni scambiate tra le due entita' siano **protette** e che queste identita' siano **autenticate** per verificarne l'identita'.

#### Comunicazione sicura
Per fare in modo che una comunicazione sia sicura, attraverso un canale insicuro come Internet dobbiamo stabilire delle proprieta' di sicurezza che devono essere garantite durante la comunicazione:
* **Confidenzialita'**: solo Alice e Bob devono poter "capire" il contenuto dei messaggi;
* **Integrita'**: i messaggi non devono venire modificati;
* **Autenticazione**: Alice e Bob devono essere sicuri che il loro interlocutore sia effettivamente chi dice di essere (e che loro si aspettano);
* **Non-repudiation**: Alice non puo' negare di aver spedito un messaggio a Bob.

#### Autenticazione nella rete
Quando si effettuano comunicazioni nella rete e' necessario specificare cosa si intenda autenticare.

##### Entity Authentication
Garantisce l'identita' dell'utente che in tempo reale sta comunicando all'interno di una specifica sessione di protocollo.

##### Message Authentication
Garantisce che il messaggio ricevuto proviene dalla sorgente indicata, senza dare alcuna indicazione di quando il messaggio sia stato effettivamente creato.

___

### Tipologia di attaccante

L'attaccante (Trudy) e' un **host malevolo** connesso ad Internet che puo' voler modificare il normale comportamento dei protocolli per scopi illeciti.

#### Protocolli TCP/IP
Alice e Bob sono due entita' che utilizzano Internet come canale di comunicazione, quindi usano i protocolli dello stack TCP/IP.

| n 	| Internet          	| ISO/OSI 7 layer model 	| n 	|
|---	|-------------------	|-----------------------	|---	|
|   	|                   	| Application           	| 7 	|
| 5 	| Application       	| Presentation          	| 6 	|
|   	|                   	| Session               	| 5 	|
| 4 	| TCP               	| Transport             	| 4 	|
| 3 	| IP                	| Network               	| 3 	|
| 2 	| Network Interface 	| Data Link>            	| 2 	|
| 1 	| Hardware          	| Physical              	| 1 	|

>I protocolli di comunicazione definiscono il formato, l'ordine dei messaggi spediti e ricevuti tra le entita' della rete, e le azioni intraprese dopo la trasmissione/ricezione

#### Cosa puo' fare un attaccante
In genere un attaccante puo' essere definito **attivo/passivo** a seconda di cosa puo' fare lungo un canale di comunicazione.
Rimanendo in ascolto lungo il canale puo' intercettare il messaggio (minacciando la confidenzialita') per poi:
* Leggere solamente il messaggio (passivo);
* Effettuare azioni sul messaggio (attivo):
  * Cancellare il messaggio senza inoltrarlo al destinatario;
  * Modificare i messaggi in transito (minaccia all'integrita');
  * Puo' spedire messaggi arbitrari (minaccia all'autenticazione);
  * Puo' riutilizzare vecchi messaggi salvati, tramite un **replay attack** (minaccia all'autenticazione).

#### Contromisure
Per impedire a Trudy di modificare il funzionamento del protocollo, e' necessario crittografare il messaggio (tramite delle **primitive crittografiche**) per continuare a garantire la confidenzialita' e fare in modo che solo Alice e Bob lo possano decifrare.

La segretezza puo' pero' non essere sufficiente per garantire anche l'autenticazione e l'integrita'.

Per fare in modo che un protocollo sia del tutto sicuro, e dunque vengano garantite tutte le proprieta' di sicurezza, sara' necessario usare una combinazione di primitive crittografiche e costruire un **protocollo di sicurezza**.

___

## Introduzione alla crittografia

### Storia della crittografia

___

### Proprieta' degli algoritmi di cifratura

Alice vuole mandare un messaggio m a Bob, mentre Trudy e' l'attaccante passivo (puo' leggere il messaggio M):
* Alice da in input all'**algoritmo di codifica** la chiave di codifica insieme al messaggio in chiaro, ottenendo il messaggio cifrato;
* Alice spedisce il messaggio cifrato a Bob attraverso il canale;
* Bob applica l'**algoritmo di decodifica** con la chiave di decodifica insieme messaggio cifrato, ottenendo il messaggio in chiaro.

#### Principio di Kerchoff
La proprieta' di un buon algoritmo di cifratura/decifratura e' sintetizzata dal **principio di Kerchoff**:
> La sicurezza e' data dalla robustezza dell'algoritmo e dalla segretezza della chiave, non della segretezza dell'algoritmo.

Per questo, nel caso precedente, Trudy puo' avere accesso al canale, dunque ai messaggi, ed essere a conoscenza dell'algoritmo di cifratura, in quanto la sicurezza e' garantita dal possesso delle chiavi di cifratura/decifratura.

In particolare valgono le seguenti affermazioni:
* **E**: funzione codifica;
* **D**: funzione decodifica;
* **m**: messaggio;
* **x**: messaggio cifrato;
* **K**: chiave per la cifratura;
* **K'**: chiave per la decifratura.

> D<sub>K'</sub>(E<sub>K</sub>(m)) == m

> E<sub>K</sub>(m) e' semplice da calcolare, dati m e K

> D<sub>K'</sub>(x) e' semplice da calcolare, dati x e K', ma per Trudy deve essere molto difficile da calcolare (in quanto non possiede K')

> Se x == E<sub>K</sub>(m), e' difficile trovare m senza K

#### Lunghezza delle chiavi
Per quanto possa essere valido un algoritmo crittografico, esso puo' essere forzato provando a decifrare il messaggio con tutte le chiavi possibili tramite un attacco bruteforce.

Per questo motivo, il numero delle chiavi possibili deve essere grande a sufficienza per rendere computazionalmente impossibile questo attacco.
Se scelgo una chiave di *n* bit, lo spazio delle chiavi sara' 2<sup>n</sup>.

#### Gestione di messaggi molto lunghi

##### Block ciphers
Algoritmo che suffivide il messaggio in blocchi di lunghezza predefinita e li cifra/decifra uno alla volta con la stessa chiave (aggiungendo dei bit finali all'ultimo blocco). Tipicamente un blocco e' di 64 bit.

##### Stream ciphers
Algoritmo che cifra il messaggio 1 bit o 1 byte alla volta usando una sequenza denominata **keystream** generata randomicamente a partire dalla chiave o dal messaggio.
___

### Crittografia a chiave simmetrica e asimmetrica

___

### Funzioni hash

___

### Firma digitale

___

### Certificato digitale