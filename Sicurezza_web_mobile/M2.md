# Controllo degli accessi e autenticazione

## Controllo degli accessi

___

### Politiche di sicurezza
Durante la pianificazione della sicurezza, nell'ambito prevenzione dobbiamo specificare:
* Da chi o da cosa ci si vuole proteggere;
* Quali proprieta' di sicurezza devono essere soddisfatte dal sistema;
* Quali sono gli utenti autorizzati e quali non;
* Che livello di segretezza hanno le risorse (top secret, secret, riservato, non classificato).

In particolare si devono:
* Definire delle **regole di accesso** e controllare che chi accedere alle risorse soddisfi tali regole;
* Verificare che il **sistema funzioni come previsto**;
* Trasmetterei i **dati non in chiaro**.

#### Regole di accesso

L'obiettivo del modulo di controllo degli accessi e' garantire che gli utenti abbiano accesso a tutte e solo le risorse e i servizi ai quali sono autorizzati, per ottenere cio' bisogna:
* Definire una **politica di sicurezza** che limiti quali operazioni gli utenti possono fare sulle risorse;
* Scegliere un **meccanismo** per far rispettare la politica (ossia implementare la politica).
* Verificare che sia la politica che il meccanismo siano validi e coerenti.

Politiche e meccanismi per il controllo degli accessi si differenziano per il livello di astrazione.
Ragionare su diversi livelli di astrazione permette di mantere separata la fase di implementazione da quella di analisi e specifica dei requisiti; inoltre permette il confronto tra diverse politiche per il controllo degli accessi e il confronto tra diversi meccanismi che implementano la stessa politica. 

E' possibile realizzare meccanismi che implementano piu' politiche ma se le politiche sono in conflitto, le discrepanze possono diventare una vulnerabilita'.

#### Politiche
Sono regole ad alto livello che descrivono gli accessi autorizzati al sistema:
* Un insieme di proprieta' di sicurezza;
* Dipendono dall'applicazione da proteggere.

Esempio in una banca:
* Autenticazione dei clienti agli sportelli, ATM e sul web;
* Non-repudiation delle transazioni;
* Integrita' dei conti correnti dei clienti;
* Segretezza dei clienti e dei dati interni;
* Disponibilita' di un sistema di allarme;
* Separation of duties (nessun conflitto di interessi).

Le politiche di sicurezza possono essere descritte con:
* Linguaggio naturale: semplice da capire ma di solito impreciso;
* Matematica: precisa ma difficile da capire;
* Linguaggio ad-hoc: pseudo codice che cerca di bilanciare la precisione con la facilita' di comprensione.

#### Meccanismi
Sono funzioni di basso livello (HW e SW che implementano le politiche).

#### Terminologia per il controllo degli accessi
Gli elementi principali sono:
* **Soggetti**: le entita' attive, come utenti e processi che richiedono l'accesso ad una certa risorsa o un servizio;
* **Oggetti**: le entita' passive, come risorse, file, servizi;
* **Operazioni di accesso (o modalita' di accesso)**: come un soggetto puo' accedere ad un oggetto (varia a seconda delle tipologie di oggetti che i soggetti richiedono);
* **Permesso (o diritto di accesso)**: possibilita' di accedere ad una risorse secondo una certa modalita'/operazione di accesso;
* **Privilegio**: un insieme di permessi dati direttamente ad un ruolo specifico (es. amministratore, operatore, ecc.).

A livello elementare le modalita' di accesso di un soggetto su un oggetto sono:
* **Osservare** un oggetto;
* **Alterare** un oggetto;

#### Esempio di modalita' di accesso su Unix/Linux
Le modalita' di accesso ai file sono:
* **read**: lettura di file;
* **write**: scrittura su file;
* **execute**: esecuzione di un file eseguibile.

Le modalita' di accesso alle directory sono:
* **read**: elencare gli elementi della directory;
* **write**: creare o rinominare file e subdirectory in una directory;
* **execute**: ricerca in una directory.

#### Funzionamento di un sistema per il controllo degli accessi 
Un sistema di controllo degli accessi regola le operazioni che possono venire eseguite sui dati e sulle risorse che devono essere protette.
L'obiettivo e' quello di controllare le operazioni eseguite dai soggetti per prevenire azioni che potrebbero danneggiare i dati o le risorse (o violare delle proprieta' di sicurezza che sono definite nella politica di sicurezza).

Il controllo in genere viene fatto dal sistema operativo e in particolare dal **reference monitor**: una macchina astratta che applica il controllo degli accessi tramite l'intercettazione delle richieste d'accesso e la fornitura di una risposta alle richieste provenienti dai soggetti.

Nel reference monitor:
* Un soggetto attivo chiede accesso ad un oggetto passsivo per eseguire una specifica operazione di accesso;
* Il monitor riceve la richiesta, consulta la polita di sicurezza che deve applicare e concede o meno l'accesso.

La correttezza dell'intero sistema di controllo degli accessi implica:
* Una corretta identificazione/autenticazione del soggetto attivo;
* Una corretta definizione e implementazione della politica di sicurezza.

Vediamo come il concetto di autenticazione e' strettamente correlato a quello di autorizzazione, ma hanno definizioni molto diverse:
* **Autenticazione**: il reference monitor verifica l'identita' del soggetto attivo che fa la richiesta;
* **Autorizzazione**: il reference monitor decide se concedere o meno l'accesso.

___
### Politiche per il controllo degli accessi

La responsabilita' di stabilire una politica puo' venire assegnata:
* Al **proprietario della risorsa**, che puo' decidere a chi e' permesso l'accesso:
  * In questo caso si parla di **politiche discrezionarie (DAC)** in quanto il controllo degli accessi e' a discrezione del proprietario.
* Ad una politica **a livello di sistema** che stabilisce gli accessi:
  * In questo caso, poiche' il sistema e' centralizzato, tali politiche si definiscono **mandatorie (MAC)**.
  
Esistono altre interpretazioni di Discretionary Access Control e Mandatory Access Control, che pero' ormai sono in disuso.

#### Discretionary Access Control
Il proprietario della risorsa:
* Decide gli accessi: chi puo' accedere e in quale modalita';
* Ha autorita' di **passare i propri privilegi** ad altri utenti: **delegation of duty**.

Il limite di questa politica e' il fatto che controlla solo gli accessi diretti alla risorsa: non c'Ã¨ alcun controllo su cosa accade alla risorsa dopo che vi e' stato concesso l'accesso ad un soggetto. Cio' predispone la politica ed essere particolarmente vunerabile ai **Trojan Horse** che contengono codice nascosto malevolo per compiere azioni illegittime.

Esempio vulnerabilita' ai Trojan Horse:
Il soggetto S1 ha accesso in lettura al file F1 e in scrittura al file F2.
Il soggetto S2 ha accesso in lettura al file F2.

Se il soggetto S1 esegue una funzione che:
* Legge da F1;
* Scrive su F2;

La politica DAC viene rispettata, ma la funziona scrivera' il contenuto di F1 su F2, rendendo possibile a S2 la lettura del file F1.

#### Mandatory Access Control
La politica mandatoria e' una politca **multilivello** gestisce in modo centralizzato gli accessi. In particolare assegna livelli di sicurezza a soggetti ed oggetti senza che i soggetti abbiano alcun controllo sul livello di sicurezza che gli viene assegnato.
La modalita' di accesso e' un attributo dell'ogetto e impone delle restrizioni sul flusso dell'informazione, per questo motivo non sono possibili attacchi di tipo Trojan Horse.

Esistono due tipi di politiche multilivello a seconda delle proprieta' di sicurezza che si vogliono garantire:
* **Bell - La Padula**: secrecy based;
* **Biba**: integrity based.

##### Modello Bell - La Padula
E' un modello usato per garantire la segretezza in cui soggetti ed oggetti vengono classificati in base al livello di sicurezza:
* Il livello del soggetto indica il livello di autorizzazione/fiducia associato all'utente;
* Il livello dell'oggetto rappresenta la sensibilita' dell'informazione.

I livelli possono formare un reticolo e possono essere di tipo:
* Trusted/Untrusted
* Public/Secret/Top Secret

Le regole della politica mandatoria che si basa su questo modello sono:
* **No write-down**: un soggetto di alto livello non puo' scrivere oggetti di livello inferiore (previene il downgrading dell'informazione);
* **No read-up**: un soggetto di livello inferiore non puo' accedere ad un oggetto di livello superiore (garantisce la segretezza).

##### Modello Biba
E' un modello usato per garantire l'integrita', per questo, soggetti ed oggetti vengono classificati per livello di integrita':
* Il livello del soggetto indica il livello di fiducia associato all'utente;
* Il livello dell'oggetto rappresenta la fiducia nella validita' dell'informazione.

Le regole sono:
* **No write-up**: non e' possibile scrivere informazioni prelevate da un oggetto di basso livello su un oggetto di piu' alto livello (dati integri potrebbero venire corrotti);
* **No read-down**: un soggetto di alto livello non puo' leggere oggetti di livello inferiore (i dati potrebbero non essere validi).

#### Role-Based Access Control
E' basato sull'idea che uno stesso soggetto puo' aver bisogno di permessi diversi a seconda dell'attivita' (ruolo) che svolge.
In questo tipo di politica l'accesso agli oggetti e' mediato dai ruoli: un soggetto s con ruolo r ha tutti i permessi associati al ruolo r.

I vantaggi di questo approccio sono:
* **Least Privilege**: ogni soggetto, nel momento in cui compie un'azione, ha il privilegio minimo per compiere tale azione;
* I permessi sono facilmente **revocabili**;
* **Separation of duty**: tramite la creazione di ruoli diversi in base all'azione che deve svolgere il soggetto;
* **Gerarchie di ruoli**;
* **Anonimity** (parziale): in quanto non e' il soggetto a compiere l'azione ma e' il soggetto con quel ruolo specifico che la sta compiendo.

Il **gruppo** e' un insieme di utenti.
Il **ruolo** e' un insieme dinamico di permessi/privilegi.

___

### Memorizzazione della matrice degli accessi
Dobbiamo tener conto anche degli aspetti implementativi quando parliamo di politiche degli accessi, e la memorizzazione di una matrice degli accessi e' spesso un tema da affrontare.

In genere, quando si realizza una matrice degli accessi, si mettono i soggetti sulle righe e gli oggetti sulle colonne, nella cella si specifica il privilegio che il determinato soggetto ha su quello specifico oggetto:
>Accesso: Soggetto X Oggetto -> Permesso

La matrice risultante e' grande e sparsa, quindi non e' efficiente memorizzarla in questo modo. In genere si memorizza:
* Per colonne: lista di soggetti che puo' accedere o meno a una data risorsa (**ACL - Access Control List**);
* Per righe: lista di risorse a cui puo' accedere un soggetto (**Capability List**);
* Solo le triple non-nulle: che e' il meccanismo utilizzato dai database (**Tabelle di autorizzazione**).

#### Access Control List
Elenca i soggetti che possono accedere all'oggetto e con quale privilegio. Si tratta di una memorizzazione piu' compatta rispetto alla matrice degli accessi, permette di avere un sommario semplice da leggere, ma e' difficile revocare i privilegi su un soggetto perche' si devono scorrere tutte le Access Control Lists per vedere se e' presente un soggetto e in caso rimuoverlo o modificarne i privilegi.

E' una memorizzazione molto utile in caso di pochi soggetti e molti oggetti.

#### Capability List
Elenca gli oggetti ai quali il soggetto puo' accedere e con quale privilegio. E' una memorizzazione compatta e particolarmente utile quando si vuole delegare a qualcuno i propri privilegi, ma scomoda per revocare una capability, in quanto si devono scorrere tutte le Capability Lists ed effettuare la modifica o rimozione.

#### Controllo degli accessi in Linux
I sistemi operativi UNIX fanno uso della politica DAC, dove:
* I soggetti sono gli utenti (root compreso);
* Ogni file ha un **proprietario** e un **gruppo**:
  * Le modalita' di accesso sono: **r**ead, **w**rite ed e**x**ecute;
  * Tutti i file sono protetti da ACLs:
    * Indicano le modalita' di accesso per user, group e others;
    * I privilegi sono indicati mediante 9 bit.
* I programmi vengono eseguiti in un'area di memoria protetta:
  * Vengono eseguiti tramite i privilegi del chiamante tranne in caso di suid/sgid.