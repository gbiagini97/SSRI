# Controllo degli accessi e autenticazione

## Controllo degli accessi

___

### Politiche di sicurezza
Durante la pianificazione della sicurezza, nell'ambito prevenzione dobbiamo specificare:
* Da chi o da cosa ci si vuole proteggere;
* Quali proprieta' di sicurezza devono essere soddisfatte dal sistema;
* Quali sono gli utenti autorizzati e quali non;
* Che livello di segretezza hanno le risorse (top secret, secret, riservato, non classificato).

In particolare si devono:
* Definire delle **regole di accesso** e controllare che chi accedere alle risorse soddisfi tali regole;
* Verificare che il **sistema funzioni come previsto**;
* Trasmetterei i **dati non in chiaro**.

#### Regole di accesso

L'obiettivo del modulo di controllo degli accessi e' garantire che gli utenti abbiano accesso a tutte e solo le risorse e i servizi ai quali sono autorizzati, per ottenere cio' bisogna:
* Definire una **politica di sicurezza** che limiti quali operazioni gli utenti possono fare sulle risorse;
* Scegliere un **meccanismo** per far rispettare la politica (ossia implementare la politica).
* Verificare che sia la politica che il meccanismo siano validi e coerenti.

Politiche e meccanismi per il controllo degli accessi si differenziano per il livello di astrazione.
Ragionare su diversi livelli di astrazione permette di mantere separata la fase di implementazione da quella di analisi e specifica dei requisiti; inoltre permette il confronto tra diverse politiche per il controllo degli accessi e il confronto tra diversi meccanismi che implementano la stessa politica. 

E' possibile realizzare meccanismi che implementano piu' politiche ma se le politiche sono in conflitto, le discrepanze possono diventare una vulnerabilita'.

#### Politiche
Sono regole ad alto livello che descrivono gli accessi autorizzati al sistema:
* Un insieme di proprieta' di sicurezza;
* Dipendono dall'applicazione da proteggere.

Esempio in una banca:
* Autenticazione dei clienti agli sportelli, ATM e sul web;
* Non-repudiation delle transazioni;
* Integrita' dei conti correnti dei clienti;
* Segretezza dei clienti e dei dati interni;
* Disponibilita' di un sistema di allarme;
* Separation of duties (nessun conflitto di interessi).

Le politiche di sicurezza possono essere descritte con:
* Linguaggio naturale: semplice da capire ma di solito impreciso;
* Matematica: precisa ma difficile da capire;
* Linguaggio ad-hoc: pseudo codice che cerca di bilanciare la precisione con la facilita' di comprensione.

#### Meccanismi
Sono funzioni di basso livello (HW e SW che implementano le politiche).

#### Terminologia per il controllo degli accessi
Gli elementi principali sono:
* **Soggetti**: le entita' attive, come utenti e processi che richiedono l'accesso ad una certa risorsa o un servizio;
* **Oggetti**: le entita' passive, come risorse, file, servizi;
* **Operazioni di accesso (o modalita' di accesso)**: come un soggetto puo' accedere ad un oggetto (varia a seconda delle tipologie di oggetti che i soggetti richiedono);
* **Permesso (o diritto di accesso)**: possibilita' di accedere ad una risorse secondo una certa modalita'/operazione di accesso;
* **Privilegio**: un insieme di permessi dati direttamente ad un ruolo specifico (es. amministratore, operatore, ecc.).

A livello elementare le modalita' di accesso di un soggetto su un oggetto sono:
* **Osservare** un oggetto;
* **Alterare** un oggetto;

#### Esempio di modalita' di accesso su Unix/Linux
Le modalita' di accesso ai file sono:
* **read**: lettura di file;
* **write**: scrittura su file;
* **execute**: esecuzione di un file eseguibile.

Le modalita' di accesso alle directory sono:
* **read**: elencare gli elementi della directory;
* **write**: creare o rinominare file e subdirectory in una directory;
* **execute**: ricerca in una directory.

#### Funzionamento di un sistema per il controllo degli accessi 
Un sistema di controllo degli accessi regola le operazioni che possono venire eseguite sui dati e sulle risorse che devono essere protette.
L'obiettivo e' quello di controllare le operazioni eseguite dai soggetti per prevenire azioni che potrebbero danneggiare i dati o le risorse (o violare delle proprieta' di sicurezza che sono definite nella politica di sicurezza).

Il controllo in genere viene fatto dal sistema operativo e in particolare dal **reference monitor**: una macchina astratta che applica il controllo degli accessi tramite l'intercettazione delle richieste d'accesso e la fornitura di una risposta alle richieste provenienti dai soggetti.

Nel reference monitor:
* Un soggetto attivo chiede accesso ad un oggetto passsivo per eseguire una specifica operazione di accesso;
* Il monitor riceve la richiesta, consulta la polita di sicurezza che deve applicare e concede o meno l'accesso.

La correttezza dell'intero sistema di controllo degli accessi implica:
* Una corretta identificazione/autenticazione del soggetto attivo;
* Una corretta definizione e implementazione della politica di sicurezza.

Vediamo come il concetto di autenticazione e' strettamente correlato a quello di autorizzazione, ma hanno definizioni molto diverse:
* **Autenticazione**: il reference monitor verifica l'identita' del soggetto attivo che fa la richiesta;
* **Autorizzazione**: il reference monitor decide se concedere o meno l'accesso.

___
### Politiche per il controllo degli accessi

La responsabilita' di stabilire una politica puo' venire assegnata:
* Al **proprietario della risorsa**, che puo' decidere a chi e' permesso l'accesso:
  * In questo caso si parla di **politiche discrezionarie (DAC)** in quanto il controllo degli accessi e' a discrezione del proprietario.
* Ad una politica **a livello di sistema** che stabilisce gli accessi:
  * In questo caso, poiche' il sistema e' centralizzato, tali politiche si definiscono **mandatorie (MAC)**.
  
Esistono altre interpretazioni di Discretionary Access Control e Mandatory Access Control, che pero' ormai sono in disuso.

#### Discretionary Access Control
Il proprietario della risorsa:
* Decide gli accessi: chi puo' accedere e in quale modalita';
* Ha autorita' di **passare i propri privilegi** ad altri utenti: **delegation of duty**.

Il limite di questa politica e' il fatto che controlla solo gli accessi diretti alla risorsa: non c'Ã¨ alcun controllo su cosa accade alla risorsa dopo che vi e' stato concesso l'accesso ad un soggetto. Cio' predispone la politica ed essere particolarmente vunerabile ai **Trojan Horse** che contengono codice nascosto malevolo per compiere azioni illegittime.

Esempio vulnerabilita' ai Trojan Horse:
Il soggetto S1 ha accesso in lettura al file F1 e in scrittura al file F2.
Il soggetto S2 ha accesso in lettura al file F2.

Se il soggetto S1 esegue una funzione che:
* Legge da F1;
* Scrive su F2;

La politica DAC viene rispettata, ma la funziona scrivera' il contenuto di F1 su F2, rendendo possibile a S2 la lettura del file F1.

#### Mandatory Access Control

